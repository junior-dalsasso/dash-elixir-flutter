syntax = "proto3";

import "google/api/annotations.proto";

package DashElixirFlutter;

// The actual RPC service definition with HTTP/2 endpoints defined
service RPC {
  rpc StreamInfo (Empty) returns (stream StreamData) {
    option (google.api.http) = {
        get: "/streamInfo"
    };
  }

  rpc startCalibration (Empty) returns (Empty) {
    option (google.api.http) = {
        get: "/startCalibration"
    };
  }

  rpc resetTrip (Empty) returns (Empty) {
    option (google.api.http) = {
        get: "/resetTrip"
    };
  }

  rpc resetHodometer (Empty) returns (Empty) {
    option (google.api.http) = {
        get: "/resetHodometer"
    };
  }

  rpc RebootSystem (Empty) returns (Empty) {
    option (google.api.http) = {
        get: "/rebootSystem"
    };
  }

  rpc listBluetoothDevices (Empty) returns (DeviceList) {
    option (google.api.http) = {
        get: "/listBluetoothDevices"
    };
  }

  rpc tryConnectDevice (Device) returns (ActionResult) {
    option (google.api.http) = {
        get: "/tryConnectDevice"
    };
  }
}

message Empty {}

message EcuData {
  float segundos_motor_ligado = 1;
  float larg_pulso_bancada_1 = 2;
  float larg_pulso_bancada_2 = 3;
  float rpm = 4;
  float avanco_ignicao = 5;
  StatusMotor status_motor = 6;
  float afr_alvo_bancada_1 = 7;
  float afr_alvo_bancada_2 = 8;
  float pressao_coletor = 9;
  float temp_ar_coletor = 10;
  float temp_agua = 11;
  float tps = 12;
  float tensao_bateria = 13;
  float sonda_banco_1 = 14;
  float sonda_banco_2 = 15;
  float correcao_banco_1 = 16;
  float correcao_banco_2 = 17;
  float correcao_ar = 18;
  float correcao_aquecimento = 19;
  float correcao_rapida = 20;
  float cutoff_tps = 21;
  float correcao_combs_baro = 22;
  float correcao_combs_total = 23;
  float valor_ve_bancada_1 = 24;
  float valor_ve_bancada_2 = 25;
  float controle_marcha_lenta = 26;
  float avanco_ignicao_frio = 27;
  float tps_variacao = 28;
  float map_variacao = 29;
  float dwell = 30;
  float carga_combustivel = 31;
  uint32 atualizacoes_amc = 32;
  uint32 kpaix_nao_usado = 33;
  float leitura_tps_adc = 34;
  float carga_combustivel_alg2 = 35;
  float carga_ignicao_alg1 = 36;
  float carga_ignicao_alg2 = 37;
  uint32 contador_sincronismo = 38;
  float erro_tempo_ignicao_pct = 39;
  uint32 tempo_entre_pulsos_us = 40;
  uint32 combustivel_parede_us = 41;
  float entrada_analogica_0 = 42;
  float entrada_analogica_1 = 43;
  float entrada_analogica_2 = 44;
  bool connected = 45;
}

message StatusMotor {
  bool motor_pronto = 1;
  bool motor_em_partida = 2;
  bool enriquecimento_partida = 3;
  bool ciclo_aquecimento = 4;
}

message ConsumptionData {
  float hodometer = 1;
  float trip = 2;
  float hodometer_consumed = 3;
  float trip_consumed = 4;
  float hodometer_fuel_by_distance = 5;
  float trip_fuel_by_distance = 6;
  float current_speed = 7;
}

message StreamData {
  EcuData ecu_data = 1;
  ConsumptionData consumption_data = 2;
}

message Device {
  string name = 1;
  string address = 2;
}

message DeviceList {
  repeated Device devices = 1;
}

message ActionResult {
  bool result = 1;
}
